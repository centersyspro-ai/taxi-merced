<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taxi Merced - Servicio de Taxis en Ciudad de México</title>
    <meta name="description" content="Taxi Merced - 15 años de servicio confiable en Ciudad de México. Servicio 24/7, viajes programados y atención inmediata por WhatsApp y teléfono.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" rel="stylesheet">
    <!-- Bootstrap 5 CSS para el modal responsive -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Variables CSS */
        :root {
            --primary-color: #FFD700; /* Amarillo taxi */
            --secondary-color: #000000; /* Negro */
            --accent-color: #333333; /* Gris oscuro */
            --text-color: #333333;
            --light-color: #f8f8f8;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --whatsapp-green: #25D366;
            --whatsapp-dark: #128C7E;
            --danger: #dc3545;
            --success: #28a745;
        }

        /* Reset y estilos base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Lato', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--white);
        }

        h1, h2, h3, h4 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 1rem;
        }

        p {
            margin-bottom: 1rem;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        .section {
            padding: 5rem 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background-color: var(--primary-color);
            margin: 0.5rem auto;
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            background-color: var(--primary-color);
            color: var(--secondary-color);
            text-decoration: none;
            border-radius: 4px;
            font-weight: 700;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            text-align: center;
        }

        .btn:hover {
            background-color: var(--secondary-color);
            color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }

        /* Header */
        header {
            background-color: var(--secondary-color);
            color: var(--white);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo img {
            width: 60px;
            height: 60px;
            margin-right: 10px;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--primary-color);
        }

        .nav-menu {
            display: flex;
            list-style: none;
        }

        .nav-menu li {
            margin-left: 1.5rem;
        }

        .nav-menu a {
            color: var(--white);
            text-decoration: none;
            font-weight: 700;
            transition: var(--transition);
            position: relative;
        }

        .nav-menu a:hover {
            color: var(--primary-color);
        }

        .nav-menu a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background-color: var(--primary-color);
            transition: var(--transition);
        }

        .nav-menu a:hover::after {
            width: 100%;
        }

        .hamburger {
            display: none;
            cursor: pointer;
        }

        .hamburger div {
            width: 25px;
            height: 3px;
            background-color: var(--white);
            margin: 5px;
            transition: var(--transition);
        }

        /* Hero Section */
        .hero {
            height: 100vh;
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('assets/images/hero.png') no-repeat center center/cover;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--white);
            margin-top: 80px;
        }

        .hero-content {
            max-width: 800px;
            padding: 0 20px;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            color: var(--primary-color);
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        /* About Section */
        .about {
            background-color: var(--light-color);
        }

        .about-content {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
        }

        .about-text {
            flex: 1;
            min-width: 300px;
            padding-right: 2rem;
        }

        .about-image {
            flex: 1;
            min-width: 300px;
            text-align: center;
        }

        .about-image img {
            border-radius: 8px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            width: 100%;
            max-width: 500px;
            height: auto;
        }

        .about-image img:hover {
            transform: scale(1.02);
        }

        /* Services Section */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .service-card {
            background-color: var(--white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .service-image {
            height: 250px;
            background-color: #e0e0e0;
            overflow: hidden;
        }

        .service-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .service-card:hover .service-image img {
            transform: scale(1.05);
        }

        .service-content {
            padding: 1.5rem;
        }

        .service-content h3 {
            color: var(--secondary-color);
            margin-bottom: 0.5rem;
        }

        /* Text-Image Sections */
        .text-image {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 4rem;
        }

        .text-image.reverse {
            flex-direction: row-reverse;
        }

        .text-image .text-content {
            flex: 1;
            min-width: 300px;
            padding: 0 2rem;
        }

        .text-image .image-content {
            flex: 1;
            min-width: 300px;
            text-align: center;
        }

        .text-image .image-content img {
            border-radius: 8px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            width: 100%;
            max-width: 500px;
            height: auto;
        }

        .text-image .image-content img:hover {
            transform: scale(1.02);
        }

        /* Gallery Section - MEJORADO */
        .gallery {
            background-color: var(--light-color);
        }

        .carousel {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .carousel-track-container {
            overflow: hidden;
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }

        .carousel-slide {
            width: 100%;
            flex-shrink: 0;
            position: relative;
        }

        .carousel-image {
            width: 100%;
            height: 500px;
            overflow: hidden;
        }

        .carousel-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .carousel-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.7);
            color: var(--white);
            padding: 1rem;
            text-align: center;
        }

        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: var(--white);
            border: none;
            font-size: 1.5rem;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: var(--transition);
            z-index: 10;
            border-radius: 4px;
        }

        .carousel-btn:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .carousel-btn.prev {
            left: 10px;
        }

        .carousel-btn.next {
            right: 10px;
        }

        .carousel-indicators {
            display: flex;
            justify-content: center;
            margin-top: 1rem;
            gap: 8px;
        }

        .carousel-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #ccc;
            cursor: pointer;
            transition: var(--transition);
            border: none;
        }

        .carousel-indicator.active {
            background-color: var(--primary-color);
            transform: scale(1.2);
        }

        .carousel-indicator:hover {
            background-color: var(--primary-color);
        }

        /* Map Section */
        .map-container {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .map-container iframe {
            display: block;
            width: 100%;
            height: 450px;
            border: none;
        }

        /* Footer */
        footer {
            background-color: var(--secondary-color);
            color: var(--white);
            padding: 3rem 0 1rem;
        }

        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-bottom: 2rem;
        }

        .footer-column {
            flex: 1;
            min-width: 250px;
            margin-bottom: 2rem;
        }

        .footer-column h3 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            position: relative;
        }

        .footer-column h3::after {
            content: '';
            position: absolute;
            width: 40px;
            height: 3px;
            background-color: var(--primary-color);
            bottom: -8px;
            left: 0;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 0.8rem;
        }

        .footer-column ul li a {
            color: var(--white);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-column ul li a:hover {
            color: var(--primary-color);
            padding-left: 5px;
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-links a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: var(--primary-color);
            color: var(--secondary-color);
            border-radius: 50%;
            text-decoration: none;
            transition: var(--transition);
        }

        .social-links a:hover {
            background-color: var(--white);
            transform: translateY(-3px);
        }

        .copyright {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* WhatsApp Button - MODIFICADO CON SVG */
        .whatsapp-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 70px;
            height: 70px;
            background-color: var(--whatsapp-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transition: var(--transition);
            animation: pulse-whatsapp 2s infinite;
            border: none;
            cursor: pointer;
        }

        .whatsapp-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
            background-color: var(--whatsapp-dark);
        }

        .whatsapp-btn svg {
            width: 38px;
            height: 38px;
            fill: var(--white);
        }

        /* Fallback si FontAwesome no carga */
        .whatsapp-btn .fa-whatsapp {
            font-size: 38px;
            color: white;
        }

        @keyframes pulse-whatsapp {
            0% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7);
            }
            70% {
                box-shadow: 0 0 0 15px rgba(37, 211, 102, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0);
            }
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .header-container {
                padding: 1rem 0;
            }

            .nav-menu {
                position: fixed;
                top: 80px;
                right: -100%;
                width: 80%;
                height: calc(100vh - 80px);
                background-color: var(--secondary-color);
                flex-direction: column;
                align-items: center;
                justify-content: flex-start;
                padding-top: 2rem;
                transition: var(--transition);
                z-index: 999;
            }

            .nav-menu.active {
                right: 0;
            }

            .nav-menu li {
                margin: 1.5rem 0;
            }

            .hamburger {
                display: block;
            }

            .hamburger.active div:nth-child(1) {
                transform: rotate(-45deg) translate(-5px, 6px);
            }

            .hamburger.active div:nth-child(2) {
                opacity: 0;
            }

            .hamburger.active div:nth-child(3) {
                transform: rotate(45deg) translate(-5px, -6px);
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .about-text, .text-image .text-content {
                padding-right: 0;
                margin-bottom: 2rem;
            }

            .text-image .text-content {
                padding: 0;
            }

            .carousel-image {
                height: 300px;
            }
            
            /* WhatsApp button más grande en móviles */
            .whatsapp-btn {
                width: 75px;
                height: 75px;
                bottom: 25px;
                right: 25px;
            }
            
            .whatsapp-btn svg {
                width: 42px;
                height: 42px;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 2rem;
            }

            .section {
                padding: 3rem 0;
            }

            .btn {
                padding: 10px 20px;
            }
            
            .whatsapp-btn {
                width: 70px;
                height: 70px;
                bottom: 20px;
                right: 20px;
            }
        }

        /* Modal Styles - COMPLETAMENTE NUEVO Y MEJORADO */
        .modal-taxi {
            font-size: 16px;
        }
        
        .modal-taxi .modal-header {
            background-color: var(--primary-color);
            color: var(--secondary-color);
            border-bottom: 3px solid var(--secondary-color);
        }
        
        .modal-taxi .modal-title {
            font-size: 1.5rem;
            font-weight: 900;
        }
        
        .modal-taxi .modal-body {
            padding: 1.5rem;
        }
        
        .modal-taxi .form-label {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--secondary-color);
        }
        
        .modal-taxi .form-control {
            font-size: 1.1rem;
            padding: 0.75rem 1rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            transition: var(--transition);
        }
        
        .modal-taxi .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(255, 215, 0, 0.25);
        }
        
        .modal-taxi .form-control-lg {
            font-size: 1.2rem;
            padding: 1rem;
        }
        
        /* Ubicación section */
        .location-options {
            background-color: var(--light-color);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .location-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 1.5rem;
        }
        
        .location-toggle-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .location-toggle-btn.active {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: var(--secondary-color);
        }
        
        .location-toggle-btn:hover:not(.active) {
            border-color: var(--primary-color);
        }
        
        .location-status {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        
        .location-status.success {
            border-left-color: var(--success);
        }
        
        .location-status.error {
            border-left-color: var(--danger);
        }
        
        .location-loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            vertical-align: middle;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Mensaje section */
        .message-section textarea {
            min-height: 120px;
            font-size: 1.1rem;
        }
        
        /* Botones de acción */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 2rem;
        }
        
        .btn-whatsapp {
            background-color: var(--whatsapp-green);
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
            padding: 1rem;
            flex: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: var(--transition);
        }
        
        .btn-whatsapp:hover {
            background-color: var(--whatsapp-dark);
            transform: translateY(-3px);
        }
        
        .btn-whatsapp:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-cancel {
            flex: 1;
            background-color: #6c757d;
            color: white;
        }
        
        .btn-cancel:hover {
            background-color: #5a6268;
        }
        
        /* Validación */
        .is-invalid {
            border-color: var(--danger) !important;
        }
        
        .invalid-feedback {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 0.25rem;
            display: none;
        }
        
        .is-invalid + .invalid-feedback {
            display: block;
        }
        
        /* Estilos para teléfonos */
        .phone-format-note {
            font-size: 0.85rem;
            color: #666;
            margin-top: 0.25rem;
        }
        
        /* Estilos para APK/APP */
        .app-mode .whatsapp-btn {
            bottom: 90px; /* Más arriba para no cubrir navegación */
        }

        .app-mode header {
            padding-top: env(safe-area-inset-top);
        }

        /* Detectar si es PWA/APK */
        @media (display-mode: standalone) {
            body {
                padding-top: env(safe-area-inset-top);
            }
            
            .hero {
                margin-top: calc(80px + env(safe-area-inset-top));
            }
        }
        
        /* Mejoras específicas para móviles en modal */
        @media (max-width: 576px) {
            .modal-taxi .modal-dialog {
                margin: 0.5rem;
            }
            
            .modal-taxi .modal-body {
                padding: 1.25rem;
            }
            
            .modal-taxi .modal-title {
                font-size: 1.3rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn-whatsapp, .btn-cancel {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <img src="assets/images/logo.jpg" alt="Taxi Merced Logo">
                <div class="logo-text">TAXI MERCED</div>
            </div>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#inicio">Inicio</a></li>
                    <li><a href="#nosotros">Nosotros</a></li>
                    <li><a href="#servicios">Servicios</a></li>
                    <li><a href="#galeria">Galería</a></li>
                    <li><a href="#contacto">Contacto</a></li>
                </ul>
                <div class="hamburger">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="inicio">
        <div class="hero-content">
            <h1>TAXI MERCED</h1>
            <p>15 años de servicio confiable en la Ciudad de México</p>
            <p>Servicio 24/7, 365 días al año</p>
            <a href="https://wa.me/524427128200" class="btn" target="_blank">Reserva por WhatsApp</a>
        </div>
    </section>

    <!-- About Section -->
    <section class="section about" id="nosotros">
        <div class="container">
            <h2 class="section-title">Sobre Nosotros</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>Con más de 15 años de experiencia, Taxi Merced se ha consolidado como una de las opciones más confiables para el transporte en la Ciudad de México. Nuestro compromiso es ofrecer un servicio seguro, puntual y profesional a todos nuestros clientes.</p>
                    <p>Nos especializamos en servicios prefijados para personas que necesitan transporte regular de lunes a viernes a la misma hora, así como en servicios bajo demanda para cualquier necesidad de movilidad en la ciudad.</p>
                    <p>Nuestro equipo de conductores está altamente capacitado y conoce perfectamente las rutas de la ciudad, garantizando que llegues a tu destino de manera segura y eficiente.</p>
                </div>
                <div class="about-image">
                    <img src="assets/images/acerca-de-nosotros.jpg" alt="Sobre nosotros" loading="lazy">
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section class="section" id="servicios">
        <div class="container">
            <h2 class="section-title">Nuestros Servicios</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-image">
                        <img src="assets/images/servicio-regular.jpg" alt="Servicio Regular de Taxi Merced" loading="lazy">
                    </div>
                    <div class="service-content">
                        <h3>Servicios Prefijados</h3>
                        <p>Ideal para personas que necesitan transporte regular de lunes a viernes a la misma hora. Programamos tu viaje y te recogemos puntualmente cada día.</p>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-image">
                        <img src="assets/images/servicio-24horas.jpg" alt="Servicio 24 Horas de Taxi Merced" loading="lazy">
                    </div>
                    <div class="service-content">
                        <h3>Servicio 24 Horas</h3>
                        <p>Disponibles las 24 horas del día, los 365 días del año. Ya sea temprano por la mañana o tarde en la noche, estamos aquí para llevarte a tu destino.</p>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-image">
                        <img src="assets/images/reserva-inmediata.jpg" alt="Reserva Inmediata de Taxi Merced" loading="lazy">
                    </div>
                    <div class="service-content">
                        <h3>Reserva Inmediata</h3>
                        <p>¿Necesitas un taxi ahora? Llámanos o escríbenos por WhatsApp y en minutos tendrás un taxi en tu ubicación.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Text-Image Section 1 -->
    <section class="section">
        <div class="container">
            <div class="text-image">
                <div class="text-content">
                    <h2>Nuestra Experiencia</h2>
                    <p>Con 15 años de servicio ininterrumpido en la Ciudad de México, hemos desarrollado un profundo conocimiento de las rutas, horarios pico y alternativas para garantizar que nuestros clientes lleguen a tiempo a sus destinos.</p>
                    <p>Nuestros conductores son seleccionados cuidadosamente y reciben capacitación continua en manejo defensivo, atención al cliente y conocimiento de la ciudad.</p>
                    <p>Miles de clientes satisfechos confían en nosotros para sus desplazamientos diarios, eventos especiales y viajes al aeropuerto.</p>
                </div>
                <div class="image-content">
                    <img src="assets/images/conductor-experimentado.jpg" alt="Conductor experimentado de Taxi Merced" loading="lazy">
                </div>
            </div>
        </div>
    </section>

    <!-- Text-Image Section 2 -->
    <section class="section">
        <div class="container">
            <div class="text-image reverse">
                <div class="text-content">
                    <h2>Compromiso con la Seguridad</h2>
                    <p>La seguridad de nuestros pasajeros es nuestra máxima prioridad. Todos nuestros vehículos son sometidos a mantenimiento preventivo regular para garantizar su óptimo funcionamiento.</p>
                    <p>Implementamos protocolos de sanitización exhaustivos en todos nuestros taxis, especialmente importantes en el contexto actual.</p>
                    <p>Nuestros conductores cumplen con todos los requisitos legales y cuentan con seguros de responsabilidad civil para mayor tranquilidad de nuestros clientes.</p>
                </div>
                <div class="image-content">
                    <img src="assets/images/taxi-seguro.jpg" alt="Taxi seguro de Taxi Merced" loading="lazy">
                </div>
            </div>
        </div>
    </section>

    <!-- Gallery Section - HTML MEJORADO -->
    <section class="section gallery" id="galeria">
        <div class="container">
            <h2 class="section-title">Nuestra Flota</h2>
            <div class="carousel">
                <div class="carousel-track-container">
                    <div class="carousel-track">
                        <!-- Slide 1 -->
                        <div class="carousel-slide">
                            <div class="carousel-image">
                                <img src="assets/images/taxi1.jpg" alt="Vehículo moderno y cómodo de Taxi Merced">
                            </div>
                            <div class="carousel-caption">
                                <p>Vehículos modernos y cómodos para tu máximo confort</p>
                            </div>
                        </div>
                        <!-- Slide 2 -->
                        <div class="carousel-slide">
                            <div class="carousel-image">
                                <img src="assets/images/taxi2.jpg" alt="Interior limpio y espacioso de Taxi Merced">
                            </div>
                            <div class="carousel-caption">
                                <p>Interiores limpios y espaciosos para viajes placenteros</p>
                            </div>
                        </div>
                        <!-- Slide 3 -->
                        <div class="carousel-slide">
                            <div class="carousel-image">
                                <img src="assets/images/taxi3.jpg" alt="Taxi equipado con tecnología de Taxi Merced">
                            </div>
                            <div class="carousel-caption">
                                <p>Equipados con la última tecnología para tu seguridad</p>
                            </div>
                        </div>
                        <!-- Slide 4 -->
                        <div class="carousel-slide">
                            <div class="carousel-image">
                                <img src="assets/images/taxi4.jpg" alt="Mantenimiento regular de Taxi Merced">
                            </div>
                            <div class="carousel-caption">
                                <p>Mantenimiento regular para garantizar tu seguridad</p>
                            </div>
                        </div>
                        <!-- Slide 5 -->
                        <div class="carousel-slide">
                            <div class="carousel-image">
                                <img src="assets/images/taxi5.jpg" alt="Conductor profesional de Taxi Merced">
                            </div>
                            <div class="carousel-caption">
                                <p>Conductores profesionales con amplia experiencia</p>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="carousel-btn prev" aria-label="Slide anterior">&#10094;</button>
                <button class="carousel-btn next" aria-label="Slide siguiente">&#10095;</button>
                <div class="carousel-indicators">
                    <button class="carousel-indicator active" data-index="0" aria-label="Ir al slide 1"></button>
                    <button class="carousel-indicator" data-index="1" aria-label="Ir al slide 2"></button>
                    <button class="carousel-indicator" data-index="2" aria-label="Ir al slide 3"></button>
                    <button class="carousel-indicator" data-index="3" aria-label="Ir al slide 4"></button>
                    <button class="carousel-indicator" data-index="4" aria-label="Ir al slide 5"></button>
                </div>
            </div>
        </div>
    </section>

    <!-- Map Section -->
    <section class="section" id="contacto">
        <div class="container">
            <h2 class="section-title">Nuestra Ubicación</h2>
            <div class="map-container">
                <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d1882.2881654136556!2d-99.17040856171164!3d19.34418222626885!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1ses!2smx!4v1764462915364!5m2!1ses!2smx" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>TAXI MERCED</h3>
                    <p>15 años de servicio confiable en la Ciudad de México. Tu seguridad y satisfacción son nuestra prioridad.</p>
                </div>
                <div class="footer-column">
                    <h3>Enlaces Rápidos</h3>
                    <ul>
                        <li><a href="#inicio">Inicio</a></li>
                        <li><a href="#nosotros">Nosotros</a></li>
                        <li><a href="#servicios">Servicios</a></li>
                        <li><a href="#galeria">Galería</a></li>
                        <li><a href="#contacto">Contacto</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contacto</h3>
                    <ul>
                        <li>Teléfono: <a href="tel:+524427128200">+52 442 712 8200</a></li>
                        <li>WhatsApp: <a href="https://wa.me/524427128200">+52 442 712 8200</a></li>
                        <li>Dirección: Calle Beta No.21, Col. Romero de Terreros, Coyoacán, Ciudad de México</li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Síguenos</h3>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                        </a>
                        <a href="#" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723 10.016 10.016 0 01-3.127 1.195 4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.937 4.937 0 004.604 3.417 9.868 9.868 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63a9.936 9.936 0 002.46-2.543l-.047-.02z"/>
                            </svg>
                        </a>
                        <a href="#" aria-label="Instagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; <span id="currentYear"></span> Taxi Merced. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- WhatsApp Button con SVG y fallback -->
    <button class="whatsapp-btn" id="whatsappBtn" aria-label="Solicitar taxi por WhatsApp" data-bs-toggle="modal" data-bs-target="#taxiModalWhatsApp">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="whatsappSVG">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893-.001-3.189-1.248-6.189-3.515-8.452"/>
        </svg>
        <!-- Fallback si SVG no carga -->
        <i class="fab fa-whatsapp" style="display: none;"></i>
    </button>

    <!-- Modal WhatsApp NUEVO Y MEJORADO -->
    <div class="modal fade modal-taxi" id="taxiModalWhatsApp" tabindex="-1" aria-labelledby="taxiModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="taxiModalLabel">
                        <i class="fab fa-whatsapp me-2"></i>SOLICITAR TAXI POR WHATSAPP
                    </h2>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                
                <div class="modal-body">
                    <!-- Información del usuario -->
                    <div class="row mb-4">
                        <div class="col-md-6 mb-3">
                            <label for="userName" class="form-label">Nombre completo *</label>
                            <input type="text" class="form-control form-control-lg" id="userName" placeholder="Ej: Juan Pérez" required>
                            <div class="invalid-feedback">Por favor ingresa tu nombre.</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="userPhone" class="form-label">Teléfono *</label>
                            <input type="tel" class="form-control form-control-lg" id="userPhone" placeholder="Ej: 4421234567" required>
                            <div class="invalid-feedback">Ingresa un teléfono válido (10 dígitos).</div>
                            <small class="phone-format-note">Formato: 10 dígitos, puede empezar con +52, 521, o 442</small>
                        </div>
                    </div>
                    
                    <!-- Sistema dual de ubicación -->
                    <div class="location-options">
                        <h5 class="mb-3"><i class="fas fa-map-marker-alt me-2"></i>¿Cómo deseas compartir tu ubicación?</h5>
                        
                        <div class="location-toggle mb-4">
                            <button type="button" class="location-toggle-btn active" id="autoLocationBtn">
                                <i class="fas fa-map-marked-alt"></i> Automática (GPS)
                            </button>
                            <button type="button" class="location-toggle-btn" id="manualLocationBtn">
                                <i class="fas fa-keyboard"></i> Manual
                            </button>
                        </div>
                        
                        <!-- Ubicación automática -->
                        <div id="autoLocationSection">
                            <div class="location-status" id="autoLocationStatus">
                                <div class="location-loading"></div>
                                <span id="autoLocationText">Obteniendo tu ubicación automáticamente...</span>
                            </div>
                            <button type="button" class="btn btn-primary mt-2" id="refreshLocationBtn">
                                <i class="fas fa-sync-alt me-1"></i> Actualizar Ubicación
                            </button>
                        </div>
                        
                        <!-- Ubicación manual -->
                        <div id="manualLocationSection" style="display: none;">
                            <label for="manualAddress" class="form-label">Escribe tu dirección completa:</label>
                            <input type="text" class="form-control mb-2" id="manualAddress" placeholder="Ej: Calle Beta No.21, Col. Romero de Terreros, Coyoacán, CDMX">
                            <small class="text-muted">Esta dirección se incluirá en el mensaje a WhatsApp.</small>
                        </div>
                    </div>
                    
                    <!-- Detalles del servicio -->
                    <div class="mb-4">
                        <label for="serviceType" class="form-label">Tipo de servicio *</label>
                        <select class="form-select form-control-lg" id="serviceType" required>
                            <option value="" selected disabled>Selecciona una opción</option>
                            <option value="Servicio Prefijado (Regular)">Servicio Prefijado (Regular)</option>
                            <option value="Servicio 24 Horas">Servicio 24 Horas</option>
                            <option value="Reserva Inmediata">Reserva Inmediata</option>
                            <option value="Viaje al Aeropuerto">Viaje al Aeropuerto</option>
                            <option value="Otro">Otro (especificar abajo)</option>
                        </select>
                    </div>
                    
                    <!-- Mensaje personalizado -->
                    <div class="mb-4">
                        <label for="userMessage" class="form-label">Detalles adicionales del servicio:</label>
                        <textarea class="form-control" id="userMessage" rows="4" placeholder="Ej: Necesito un taxi para 4 personas, con equipaje, mañana a las 8:00 AM, dirección al Centro Histórico..."></textarea>
                        <small class="text-muted">Describe con detalle lo que necesitas para un mejor servicio.</small>
                    </div>
                    
                    <!-- Botones de acción -->
                    <div class="action-buttons">
                        <button type="button" class="btn btn-secondary btn-cancel" data-bs-dismiss="modal">
                            <i class="fas fa-times me-1"></i> Cancelar
                        </button>
                        <button type="button" class="btn btn-success btn-whatsapp" id="sendWhatsAppBtn" disabled>
                            <i class="fab fa-whatsapp me-2"></i> Enviar por WhatsApp
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS y Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

    <script>
        // Año actual automático
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Detectar si es PWA/APK
        if (window.matchMedia('(display-mode: standalone)').matches || 
            window.navigator.standalone === true ||
            document.referrer.includes('android-app://')) {
            document.body.classList.add('app-mode');
        }

        // Mobile Menu Toggle
        const hamburger = document.querySelector('.hamburger');
        const navMenu = document.querySelector('.nav-menu');

        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        document.querySelectorAll('.nav-menu a').forEach(link => {
            link.addEventListener('click', () => {
                hamburger.classList.remove('active');
                navMenu.classList.remove('active');
            });
        });

        // CARRUSEL - MEJORADO Y SIMPLIFICADO
        document.addEventListener('DOMContentLoaded', function() {
            const carousel = document.querySelector('.carousel');
            const track = document.querySelector('.carousel-track');
            const slides = document.querySelectorAll('.carousel-slide');
            const nextButton = document.querySelector('.carousel-btn.next');
            const prevButton = document.querySelector('.carousel-btn.prev');
            const indicators = document.querySelectorAll('.carousel-indicator');
            
            let currentIndex = 0;
            const totalSlides = slides.length;
            
            function updateCarousel() {
                track.style.transform = `translateX(-${currentIndex * 100}%)`;
                
                indicators.forEach((indicator, index) => {
                    indicator.classList.toggle('active', index === currentIndex);
                    indicator.setAttribute('aria-label', `Ir al slide ${index + 1}`);
                });
            }
            
            function goToSlide(index) {
                currentIndex = index;
                updateCarousel();
            }
            
            function nextSlide() {
                currentIndex = (currentIndex + 1) % totalSlides;
                updateCarousel();
            }
            
            function prevSlide() {
                currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
                updateCarousel();
            }
            
            nextButton.addEventListener('click', nextSlide);
            prevButton.addEventListener('click', prevSlide);
            
            indicators.forEach((indicator, index) => {
                indicator.addEventListener('click', () => goToSlide(index));
            });
            
            carousel.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight') nextSlide();
                if (e.key === 'ArrowLeft') prevSlide();
            });
            
            let autoSlide = setInterval(nextSlide, 5000);
            
            carousel.addEventListener('mouseenter', () => {
                clearInterval(autoSlide);
            });
            
            carousel.addEventListener('mouseleave', () => {
                autoSlide = setInterval(nextSlide, 5000);
            });
            
            updateCarousel();
        });

        // WhatsApp Modal - NUEVO SISTEMA MEJORADO (CORREGIDO)
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos del modal
            const taxiModal = new bootstrap.Modal(document.getElementById('taxiModalWhatsApp'));
            const whatsappBtn = document.getElementById('whatsappBtn');
            const sendWhatsAppBtn = document.getElementById('sendWhatsAppBtn');
            const refreshLocationBtn = document.getElementById('refreshLocationBtn');
            const autoLocationBtn = document.getElementById('autoLocationBtn');
            const manualLocationBtn = document.getElementById('manualLocationBtn');
            const autoLocationSection = document.getElementById('autoLocationSection');
            const manualLocationSection = document.getElementById('manualLocationSection');
            const autoLocationText = document.getElementById('autoLocationText');
            const autoLocationStatus = document.getElementById('autoLocationStatus');
            
            // Campos del formulario
            const userName = document.getElementById('userName');
            const userPhone = document.getElementById('userPhone');
            const serviceType = document.getElementById('serviceType');
            const userMessage = document.getElementById('userMessage');
            const manualAddress = document.getElementById('manualAddress');
            
            // Variables
            let userLocation = null;
            let addressText = '';
            let useAutoLocation = true;
            const taxiMercedPhone = '524427128200'; // Número FIJO de Taxi Merced (destino)
            
            // Fallback para SVG
            const whatsappSVG = document.getElementById('whatsappSVG');
            if (!whatsappSVG || whatsappSVG.getBoundingClientRect().width === 0) {
                document.querySelector('.whatsapp-btn svg').style.display = 'none';
                document.querySelector('.whatsapp-btn .fa-whatsapp').style.display = 'block';
            }
            
            // Abrir modal al hacer click en WhatsApp
            whatsappBtn.addEventListener('click', function() {
                taxiModal.show();
                if (useAutoLocation) {
                    getAutoLocation();
                }
            });
            
            // Alternar entre ubicación automática y manual
            autoLocationBtn.addEventListener('click', function() {
                useAutoLocation = true;
                autoLocationBtn.classList.add('active');
                manualLocationBtn.classList.remove('active');
                autoLocationSection.style.display = 'block';
                manualLocationSection.style.display = 'none';
                getAutoLocation();
            });
            
            manualLocationBtn.addEventListener('click', function() {
                useAutoLocation = false;
                manualLocationBtn.classList.add('active');
                autoLocationBtn.classList.remove('active');
                manualLocationSection.style.display = 'block';
                autoLocationSection.style.display = 'none';
                updateSendButton();
            });
            
            // Actualizar ubicación automática
            refreshLocationBtn.addEventListener('click', getAutoLocation);
            
            // Obtener ubicación automática
            function getAutoLocation() {
                if (!useAutoLocation) return;
                
                autoLocationText.textContent = 'Obteniendo tu ubicación...';
                autoLocationStatus.className = 'location-status';
                sendWhatsAppBtn.disabled = true;
                
                if (!navigator.geolocation) {
                    autoLocationText.textContent = '❌ Tu navegador no soporta geolocalización';
                    autoLocationStatus.classList.add('error');
                    return;
                }
                
                navigator.geolocation.getCurrentPosition(
                    // Éxito
                    function(position) {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        userLocation = { lat, lng };
                        
                        // Obtener dirección
                        getAddressFromCoordinates(lat, lng);
                    },
                    // Error
                    function(error) {
                        let errorMessage = '❌ No se pudo obtener la ubicación';
                        
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage = '❌ Permiso de ubicación denegado. Por favor habilita la ubicación en tu navegador o usa la opción manual.';
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage = '❌ Información de ubicación no disponible.';
                                break;
                            case error.TIMEOUT:
                                errorMessage = '❌ Tiempo de espera agotado para obtener la ubicación.';
                                break;
                        }
                        
                        autoLocationText.textContent = errorMessage;
                        autoLocationStatus.classList.add('error');
                        updateSendButton();
                    },
                    // Opciones
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            }
            
            // Obtener dirección a partir de coordenadas
            function getAddressFromCoordinates(lat, lng) {
                fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1&accept-language=es`)
                    .then(response => response.json())
                    .then(data => {
                        if (data && data.display_name) {
                            addressText = data.display_name;
                            autoLocationText.textContent = `📍 ${addressText}`;
                            autoLocationStatus.classList.add('success');
                        } else {
                            addressText = `${lat.toFixed(6)}, ${lng.toFixed(6)}`;
                            autoLocationText.textContent = `📍 Ubicación: ${addressText}`;
                            autoLocationStatus.classList.add('success');
                        }
                        updateSendButton();
                    })
                    .catch(error => {
                        addressText = `${lat.toFixed(6)}, ${lng.toFixed(6)}`;
                        autoLocationText.textContent = `📍 Ubicación: ${addressText}`;
                        autoLocationStatus.classList.add('success');
                        updateSendButton();
                    });
            }
            
            // Validar teléfono mexicano (solo para incluirlo en el mensaje)
            function validateMexicanPhone(phone) {
                // Limpiar el número
                const cleanPhone = phone.replace(/\D/g, '');
                
                // Validar formatos:
                // 1. 10 dígitos: 4421234567
                // 2. 12 dígitos con 52: 524421234567
                // 3. 13 dígitos con 521: 5214421234567
                
                if (cleanPhone.length === 10) {
                    return cleanPhone; // Formato local
                } else if (cleanPhone.length === 12 && cleanPhone.startsWith('52')) {
                    return cleanPhone.substring(2); // Quitar el 52
                } else if (cleanPhone.length === 13 && cleanPhone.startsWith('521')) {
                    return cleanPhone.substring(3); // Quitar el 521
                } else if (cleanPhone.length === 11 && cleanPhone.startsWith('1')) {
                    return cleanPhone.substring(1); // Quitar el 1 inicial
                }
                
                return null;
            }
            
            // Validar formulario
            function validateForm() {
                let isValid = true;
                
                // Validar nombre
                if (!userName.value.trim()) {
                    userName.classList.add('is-invalid');
                    isValid = false;
                } else {
                    userName.classList.remove('is-invalid');
                }
                
                // Validar teléfono (solo para mensaje)
                const phoneValid = validateMexicanPhone(userPhone.value);
                if (!phoneValid) {
                    userPhone.classList.add('is-invalid');
                    isValid = false;
                } else {
                    userPhone.classList.remove('is-invalid');
                }
                
                // Validar tipo de servicio
                if (!serviceType.value) {
                    serviceType.classList.add('is-invalid');
                    isValid = false;
                } else {
                    serviceType.classList.remove('is-invalid');
                }
                
                // Validar ubicación
                if (useAutoLocation) {
                    if (!userLocation) {
                        isValid = false;
                    }
                } else {
                    if (!manualAddress.value.trim()) {
                        manualAddress.classList.add('is-invalid');
                        isValid = false;
                    } else {
                        manualAddress.classList.remove('is-invalid');
                    }
                }
                
                return isValid;
            }
            
            // Actualizar estado del botón de enviar
            function updateSendButton() {
                const isValid = validateForm();
                sendWhatsAppBtn.disabled = !isValid;
            }
            
            // Event listeners para validación en tiempo real
            userName.addEventListener('input', updateSendButton);
            userPhone.addEventListener('input', updateSendButton);
            serviceType.addEventListener('change', updateSendButton);
            userMessage.addEventListener('input', updateSendButton);
            manualAddress.addEventListener('input', updateSendButton);
            
            // Enviar mensaje por WhatsApp - CORREGIDO
            sendWhatsAppBtn.addEventListener('click', function() {
                if (!validateForm()) {
                    return;
                }
                
                // Obtener teléfono del cliente (para incluirlo en el mensaje)
                const clientPhone = validateMexicanPhone(userPhone.value);
                const clientPhoneFormatted = clientPhone ? `+52${clientPhone}` : userPhone.value.trim();
                
                // Determinar ubicación
                let locationText = '';
                let mapsUrl = '';
                
                if (useAutoLocation && userLocation) {
                    locationText = addressText || `${userLocation.lat.toFixed(6)}, ${userLocation.lng.toFixed(6)}`;
                    mapsUrl = `https://www.google.com/maps?q=${userLocation.lat},${userLocation.lng}`;
                } else if (!useAutoLocation && manualAddress.value.trim()) {
                    locationText = manualAddress.value.trim();
                    mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(locationText)}`;
                }
                
                // Construir mensaje
                let message = `¡Hola Taxi Merced! Necesito un servicio de taxi.\n\n`;
                message += `*Información del cliente:*\n`;
                message += `• Nombre: ${userName.value.trim()}\n`;
                message += `• Teléfono: ${clientPhoneFormatted}\n\n`;
                message += `*Detalles del servicio:*\n`;
                message += `• Tipo: ${serviceType.value}\n`;
                message += `• Ubicación: ${locationText}\n`;
                message += `• Enlace a Google Maps: ${mapsUrl}\n`;
                
                if (userMessage.value.trim()) {
                    message += `• Detalles adicionales: ${userMessage.value.trim()}\n`;
                }
                
                message += `\n*Taxi Merced* - 15 años de servicio confiable`;
                
                // Codificar mensaje para URL
                const encodedMessage = encodeURIComponent(message);
                
                // Determinar URL de WhatsApp
                // EL DESTINO SIEMPRE ES EL NÚMERO DE TAXI MERCED
                let whatsappUrl = '';
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
                
                if (isMobile && !isIOS) {
                    // Android: abre app nativa hacia Taxi Merced
                    whatsappUrl = `whatsapp://send?phone=${taxiMercedPhone}&text=${encodedMessage}`;
                } else {
                    // iOS y desktop: abre WhatsApp Web hacia Taxi Merced
                    whatsappUrl = `https://wa.me/${taxiMercedPhone}?text=${encodedMessage}`;
                }
                
                // Abrir WhatsApp (siempre hacia Taxi Merced)
                window.open(whatsappUrl, '_blank');
                
                // Cerrar modal después de un breve retraso
                setTimeout(() => {
                    taxiModal.hide();
                    resetForm();
                }, 500);
            });
            
            // Resetear formulario
            function resetForm() {
                userName.value = '';
                userPhone.value = '';
                serviceType.value = '';
                userMessage.value = '';
                manualAddress.value = '';
                
                userLocation = null;
                addressText = '';
                
                autoLocationText.textContent = 'Obteniendo tu ubicación...';
                autoLocationStatus.className = 'location-status';
                
                userName.classList.remove('is-invalid');
                userPhone.classList.remove('is-invalid');
                serviceType.classList.remove('is-invalid');
                manualAddress.classList.remove('is-invalid');
                
                sendWhatsAppBtn.disabled = true;
                
                // Volver a ubicación automática
                useAutoLocation = true;
                autoLocationBtn.classList.add('active');
                manualLocationBtn.classList.remove('active');
                autoLocationSection.style.display = 'block';
                manualLocationSection.style.display = 'none';
            }
            
            // Inicializar
            getAutoLocation();
        });
    </script>
</body>
</html>